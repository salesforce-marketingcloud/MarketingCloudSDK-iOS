<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">

        <title>MarketingCloudSDK iOS (v5.0.0) : Geofence and Beacon Messaging</title>
        <meta name="description" content="">

        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/syntax.css">
        <link rel="stylesheet" href="/css/main.css">
    </head>
    <body>

        <div class="container">
            <div class=row-fluid>
                <div id=header class=span12>
                    <h4><a class=brand href="/">MarketingCloudSDK iOS (v5.0.0)</a>
    
    
</h4>


                </div>
            </div>

            <div class=row-fluid>
                
                
                    <div id=navigation class=span2>
                        <ul class="nav nav-list">
    <li><a href="/">Home</a></li>
    
        
        

        
    
        
        

        
            
                <li class=nav-header>Get Started</li>
            
            <li data-order="2"><a href="/get-started/test-first-push.html">Test SDK Setup</a></li>
        
            
            <li data-order="1"><a href="/get-started/apple.html">Initial SDK Setup</a></li>
        
    
        
        

        
    
        
        

        
    
        
        

        
            
                <li class=nav-header>SDK Implementation</li>
            
            <li data-order="3"><a href="/sdk-implementation/data-privacy-iOS.html">Data Protection and Privacy</a></li>
        
            
            <li data-order="5"><a href="/sdk-implementation/iOS-9.html">iOS 9 Implementation</a></li>
        
            
            <li data-order="1"><a href="/sdk-implementation/sdk-migration.html">SDK Migration to Version 5.x</a></li>
        
            
            <li data-order="2"><a href="/sdk-implementation/business-unit-switching.html">Switch Business Units</a></li>
        
    
        
        

        
            
                <li class=nav-header>Push Notifications</li>
            
            <li data-order="1"><a href="/push-notifications/push-notifications.html">Push Notifications Overview</a></li>
        
            
            <li data-order="4"><a href="/push-notifications/rich-notifications.html">Rich Notifications</a></li>
        
            
            <li data-order="3"><a href="/push-notifications/interactive-notifications.html">Interactive Notifications</a></li>
        
            
            <li data-order="2"><a href="/push-notifications/custom-sound.html">Custom Sound</a></li>
        
            
            <li data-order="5"><a href="/push-notifications/custom-keys.html">Custom Keys</a></li>
        
    
        
        

        
            
                <li class=nav-header>User Data</li>
            
            <li data-order="1"><a href="/user-data/user-data.html">User Data Overview</a></li>
        
            
            <li data-order="2"><a href="/user-data/contact-key.html">Contact Key</a></li>
        
            
            <li data-order="6"><a href="/user-data/data-migration.html">User Data Migration</a></li>
        
            
            <li data-order="3"><a href="/user-data/tags.html">Tags</a></li>
        
            
            <li data-order="4"><a href="/user-data/attributes.html">Attributes</a></li>
        
    
        
        

        
            
                <li class=nav-header>OpenDirect</li>
            
            <li data-order="4"><a href="/opendirect/opendirect.html">OpenDirect</a></li>
        
    
        
        

        
            
                <li class=nav-header>Location Services</li>
            
            <li data-order="1"><a href="/location/geolocation-overview.html">Geofence and Beacon Messaging</a></li>
        
            
            <li data-order="2"><a href="/location/geolocation.html">Background Location Updates</a></li>
        
    
        
        

        
            
                <li class=nav-header>Inbox</li>
            
            <li data-order="1"><a href="/inbox/inbox.html">Inbox</a></li>
        
    
        
        

        
            
                <li class=nav-header>Analytics</li>
            
            <li data-order="2"><a href="/analytics/personalization-collect.html">Personalization Builder and Collect API Integration</a></li>
        
            
            <li data-order="1"><a href="/analytics/analytics.html">Analytics</a></li>
        
    
        
        

        
    
        
        

        
            
                <li class=nav-header>Troubleshooting</li>
            
            <li data-order="2"><a href="/trouble/multiple-push-sdks.html">Multiple Push SDKs Troubleshooting</a></li>
        
            
            <li data-order="1"><a href="/trouble/ios-debugging.html">iOS Debugging</a></li>
        
    
        
        

        
    
        
        

        
    
<!-- List additional links. It is recommended to add a divider
    e.g. <li class=divider></li> first to break up the content. -->
</ul>

                    </div>

                    <div id=content class=span10>
                        <div class=page-header>
    <h2>Geofence and Beacon Messaging</h2>
</div>

<p>If location is enabled in your MarketingCloudSDKConfiguration.json file, you can call a single method to use the Marketing Cloud location messaging feature.</p>

<h2 id="location-messaging">Location Messaging</h2>

<p>In addition, Apple requires adding keys to your Info.plist file to enable location services:</p>

<ul>
  <li>NSLocationAlwaysUsageDescription</li>
  <li>NSLocationAlwaysAndWhenInUseUsageDescription</li>
  <li>NSLocationWhenInUseUsageDescription</li>
</ul>

<p>Review the <a href="https://developer.apple.com/documentation/corelocation/choosing_the_authorization_level_for_location_services">Apple documentation</a> for more information.</p>

<p><img class="img-responsive" src="/assets/location.png" /><br /></p>

<blockquote>
  <p>MarketingCloudSDK requires “Always” permissions for full geofence and beacon functionality. An application does not receive location messages if “When-in-use authorization” is selected by the app user.</p>
</blockquote>

<p>When your application is ready to enable location features, including geofence and beacon messaging, call the MarketingCloudSDK framework’s method to start watching location.
<script src="https://gist.github.com/07e4a6508960c6b96276cc71cb08a772.js"></script>
<script src="https://gist.github.com/31864111e51c70fc25581891444ec344.js"></script></p>

<p>The MarketingCloudSDK+Location.h” header file details additional methods to get information about location and control the frameworks behavior.</p>

<blockquote>
  <p>MobilePush prevents the app from displaying a geofence message with an empty alert. If you include AMPscript in your message that returns no content or an empty string, the mobile app does not display that message.</p>
</blockquote>

<h2 id="beacon-support">Beacon Support</h2>

<p>We enable beacon support when you implement the location requirements on this page.</p>

<p>To range for beacons in the background, add an entry to your app’s Info.plist. This permission ensures that your app can range for beacons when your app is in the background or suspended.</p>

<p>Implement this key to enable this function. “App registers for location updates” is required to enable location in the MarketingCloudSDK and to range for beacons in the background.</p>

<p><br />
<img class="img-responsive" src="/assets/background_modes_plist_entry.png" /><br /></p>

<blockquote>
  <p>MobilePush prevents the app from displaying a beacon message with an empty alert. If you include AMPscript in your message that returns no content or an empty string, the mobile app will not display that message.</p>
</blockquote>

<blockquote>
  <p>To understand how beacons behave in different situations, review the MobilePush beacons help documentation (http://help.marketingcloud.com/en/documentation/mobilepush/beacons_overview/beacon_behavior/).</p>
</blockquote>

<p>If you create your own CLLocationManager object, we cannot guarantee that features of our SDK will work as intended.</p>

<p>If you have enabled notifications using MarketingCloudSDK and have called -sfmc_startWatchingLocation,  you can access the device’s last known location using the SDK.</p>

<script src="https://gist.github.com/fcb816bf9df1b7d26d300c22822f88c6.js"></script>

<script src="https://gist.github.com/02d2c7f15461981015658691d81a4685.js"></script>



                    </div>
                
            </div>

            

            <div class=row-fluid>
                <div id=footer class=span12>
                    Documentation for <a href="https://github.com/salesforce-marketingcloud/MarketingCloudSDK-iOS" target="_blank">MarketingCloudSDK iOS (v5.0.0)</a>

                </div>
            </div>
        </div>

        <script>
            function orderNav() {
                var list,
                    section,
                    header,
                    sections = [],
                    lists = {},
                    headers = {};

                var navUl = document.querySelectorAll('#navigation ul')[0],
                    navLis = document.querySelectorAll('#navigation ul li');

                if (!navUl) return;

                for (var i = 0; i < navLis.length; i++) {
                    var order, li = navLis[i];

                    if (li.classList.contains('nav-header')) {
                        section = li.textContent || li.innerText;
                        sections.push(section);
                        headers[section] = li;
                        continue;
                    }

                    if (!lists[section]) {
                        lists[section] = [];
                    }

                    order = parseFloat(li.getAttribute('data-order'))
                    lists[section].push([order, li]);
                }

                for (var i = 0; i < sections.length; i++) {
                    section = sections[i];
                    list = lists[section].sort(function(a, b) {
                        return a[0] - b[0];
                    });

                    if (header = headers[section]) {
                        navUl.appendChild(header);
                    }
                    for (var j = 0; j < list.length; j++) {
                        navUl.appendChild(list[j][1]);
                    }
                }
            }

            if (document.querySelectorAll) orderNav();
        </script>

        
            <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-82902574-4', 'auto');
  ga('send', 'pageview');
</script>

        
    </body>
</html>
